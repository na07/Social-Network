{% extends 'base/base.html' %}

{% block style %}body {
background-color: #9de2ff;
}{% endblock %}

{% block content %}
<div class="px-4 py-5">
  <div class="row d-flex justify-content-center">
    <div class="col col-md-9 col-lg-7 col-xl-6">
      <div class="card" style="border-radius: 15px;">
        <div class="card-body p-4">
          <div class="d-flex">
            <div class="flex-shrink-0">
              <img src="https://mdbcdn.b-cdn.net/img/Photos/new-templates/bootstrap-profiles/avatar-1.webp"
                alt="Generic placeholder image" class="img-fluid" style="width: 180px; border-radius: 10px;">
            </div>
            <div class="flex-grow-1 ms-3">
              <h5 class="mb-1">{{ profile.owner }}</h5>
              <p class="mb-2 pb-1">Senior Journalist</p>
              <div class="d-flex justify-content-start rounded-3 p-2 mb-2 bg-body-tertiary">
                <div>
                  <p class="small text-muted mb-1">Articles</p>
                  <p class="mb-0">41</p>
                </div>
                <div class="px-3">
                  <p class="small text-muted mb-1">Followers</p>
                  <p class="mb-0">976</p>
                </div>
                <div>
                  <p class="small text-muted mb-1">Rating</p>
                  <p class="mb-0">8.5</p>
                </div>
              </div>
              <div class="d-flex pt-1">
                <form action="{% url 'sn:friendship' profile.owner.id %}" method="post">
                  {% csrf_token %}
                  <button type="submit" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary flex-grow-1 me-1">Add Friend</button>
                </form>
                <button type="button" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary flex-grow-1 me-1">change</button>
                <form action="{% url 'sn:subscribe' profile.owner.id %}" method="post">
                    {% csrf_token %}
                    <button type="submit" class="btn btn-primary flex-grow-1">
                      Follow
                  </button>
                <a href="{% url 'sn:friends_requests' %}" data-mdb-button-init data-mdb-ripple-init class="btn btn-primary flex-grow-1 me-1">list</a>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% if request.user == profile.owner %}
<div class="px-4 py-500">
  <div class="row d-flex justify-content-center">
    <div class="col col-md-9 col-lg-7 col-xl-6">
      <div class="card" style="border-radius: 5px;">
        <div class="card-body p-4">
          <div class="d-flex">
            <div class="flex-shrink-0">
              <h2>Друзья</h2>
              <ul>
                {% for friendship in friends %}
                  {% if friendship.confirmed %}
                    <li>
                      {{ friendship.friend.username }}
                      <a href="{% url 'sn:delete_friend' friendship.id %}">Удалить из друзей</a>
                    </li>
                  {% endif %}
                {% empty %}
                  <li>У вас пока нет друзей.</li>
                {% endfor %}
              </ul>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endif %}
<div class="px-4 py-500 mt-5">
  <div class="row d-flex justify-content-center">
    <div class="col col-md-9 col-lg-7 col-xl-6">
      <div class="card" style="border-radius: 20px;">
        <div class="card-body p-4">
          <div class="d-flex">
            <div class="flex-shrink-0">
              <div class="container py-4">
                <style>
                  .post-card {
                    border: 1px solid #dee2e6;
                    border-radius: 12px;
                    padding: 16px 20px;
                    display: flex;
                    justify-content: space-between;
                    align-items: flex-start;
                    background-color: #fff;
                    max-width: 500px;
                    box-shadow: 0 4px 10px rgba(0,0,0,0.03);
                  }

                  .post-content {
                    flex-grow: 1;
                  }

                  .post-title {
                    font-weight: 600;
                    font-size: 1.1rem;
                    margin-bottom: 4px;
                  }

                  .post-text {
                    color: #343a40;
                    font-size: 0.95rem;
                  }

                  .post-meta {
                    text-align: right;
                    margin-left: 16px;
                    white-space: nowrap;
                  }

                  .post-author {
                    font-size: 0.85rem;
                    color: #6c757d;
                  }

                  .status-badge {
                    font-size: 0.75rem;
                    padding: 0.3em 0.75em;
                    border-radius: 999px;
                    margin-top: 12px;
                    display: inline-block;
                  }
                </style>
                {% for post in posts %}
                  <div class="post-card mb-3">
                    <div class="post-content">
                      <div class="post-title">{{ post.title }}</div>
                      <div class="post-text">{{ post.text }}</div>
                    </div>
                    <div class="post-meta">
                      <div class="post-author">{{ post.author }}</div>
                      {% if post.status == "published" %}
                        <span class="badge bg-success status-badge">Опубликовано</span>
                      {% elif post.status == "draft" %}
                        <span class="badge bg-warning text-dark status-badge">Черновик</span>
                      {% else %}
                        <span class="badge bg-secondary status-badge">Неизвестно</span>
                      {% endif %}
                    </div>
                  </div>
                {% endfor %}
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
